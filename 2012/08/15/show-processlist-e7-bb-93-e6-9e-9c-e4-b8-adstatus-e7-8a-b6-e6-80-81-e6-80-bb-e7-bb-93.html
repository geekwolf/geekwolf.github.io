<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">






  
  
  <link rel="stylesheet" media="all" href="/lib/Han/dist/han.min.css?v=3.3">




<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Mysql,processlist状态," />





  <link rel="alternate" href="/atom.xml" title="Geekwolf's Blog" type="application/atom+xml" />




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="&amp;#160; 在Show processlist输出中的Status项: 5.1手册中没有的或者翻译有问题的，都附带5.5原文说明： After createThis occurs when the thread creates a table (including internal temporary tables), at the end of the function that create">
<meta name="keywords" content="Mysql,processlist状态">
<meta property="og:type" content="article">
<meta property="og:title" content="show processlist结果中status状态总结">
<meta property="og:url" content="http://www.simlinux.com/2012/08/15/show-processlist-e7-bb-93-e6-9e-9c-e4-b8-adstatus-e7-8a-b6-e6-80-81-e6-80-bb-e7-bb-93.html">
<meta property="og:site_name" content="Geekwolf&#39;s Blog">
<meta property="og:description" content="&amp;#160; 在Show processlist输出中的Status项: 5.1手册中没有的或者翻译有问题的，都附带5.5原文说明： After createThis occurs when the thread creates a table (including internal temporary tables), at the end of the function that create">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2017-09-12T01:12:15.161Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="show processlist结果中status状态总结">
<meta name="twitter:description" content="&amp;#160; 在Show processlist输出中的Status项: 5.1手册中没有的或者翻译有问题的，都附带5.5原文说明： After createThis occurs when the thread creates a table (including internal temporary tables), at the end of the function that create">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.simlinux.com/2012/08/15/show-processlist-e7-bb-93-e6-9e-9c-e4-b8-adstatus-e7-8a-b6-e6-80-81-e6-80-bb-e7-bb-93.html"/>





  <title>show processlist结果中status状态总结 | Geekwolf's Blog</title>
  












  <div style="display: none;">
    <script src="//s13.cnzz.com/z_stat.php?id=1264375041&web_id=1264375041" language="JavaScript"></script>
  </div>





</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Geekwolf's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Quick notes</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br />
            
            站点地图
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.simlinux.com/2012/08/15/show-processlist-e7-bb-93-e6-9e-9c-e4-b8-adstatus-e7-8a-b6-e6-80-81-e6-80-bb-e7-bb-93.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Geekwolf">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/wolf.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Geekwolf's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">show processlist结果中status状态总结</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2012-08-15T05:42:58+08:00">
                2012-08-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux运维/" itemprop="url" rel="index">
                    <span itemprop="name">Linux运维</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2012/08/15/show-processlist-e7-bb-93-e6-9e-9c-e4-b8-adstatus-e7-8a-b6-e6-80-81-e6-80-bb-e7-bb-93.html" class="leancloud_visitors" data-flag-title="show processlist结果中status状态总结">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              

              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长</span>
                
                <span title="阅读时长">
                  21
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body han-init-context" itemprop="articleBody">

      
      

      
        <p>&#160;</p>
<p>在Show processlist输出中的Status项: 5.1手册中没有的或者翻译有问题的，都附带5.5原文说明：</p>
<h5 id="After-create"><a href="#After-create" class="headerlink" title="After create"></a>After create</h5><p>This occurs when the thread creates a table (including internal temporary tables), at the end of the function that creates the table. This state is used even if the table could not be created due to some error.</p>
<p>这个状态当线程创建一个表（包括内部临时表）时，在这个建表功能结束时出现。即使某些错误导致建表失败，也会使用这个状态。</p>
<h5 id="Analyzing"><a href="#Analyzing" class="headerlink" title="Analyzing"></a>Analyzing</h5><p>The thread is calculating a MyISAM table key distributions (for example, for ANALYZE TABLE).</p>
<p>当计算MyISAM表索引分布时。（比如进行ANALYZE TABLE时）</p>
<h5 id="checking-permissions"><a href="#checking-permissions" class="headerlink" title="checking permissions"></a>checking permissions</h5><p>The thread is checking whether the server has the required privileges to execute the statement.</p>
<p>这个线程检查服务器是否有具有执行该语句的所需权限。</p>
<h5 id="Checking-table"><a href="#Checking-table" class="headerlink" title="Checking table"></a>Checking table</h5><p>The thread is performing a table check operation.</p>
<p>线程正在执行表检查操作。</p>
<h5 id="cleaning-up"><a href="#cleaning-up" class="headerlink" title="cleaning up"></a>cleaning up</h5><p>The thread has processed one command and is preparing to free memory and reset certain state variables.</p>
<p>线程处理一个命令，并正准备释放内存和重置某些状态变量。</p>
<h5 id="closing-tables"><a href="#closing-tables" class="headerlink" title="closing tables"></a>closing tables</h5><p>The thread is flushing the changed table data to disk and closing the used tables. This should be a fast operation. If not, verify that you do not have a full disk and that the disk is not in very heavy use.</p>
<p>线程正在将变更的表中的数据刷新到磁盘上并正在关闭使用过的表。这应该是一个快速的操作。如果不快，则应该检查硬盘空间是否已满或者硬盘IO是否达到瓶颈。</p>
<h5 id="converting-HEAP-to-MyISAM"><a href="#converting-HEAP-to-MyISAM" class="headerlink" title="converting HEAP to MyISAM"></a>converting HEAP to MyISAM</h5><p>The thread is converting an internal temporary table from a MEMORY table to an on-disk MyISAM table.</p>
<p>线程将一个内部临时表转换为磁盘上的MyISAM表。</p>
<h5 id="copy-to-tmp-table"><a href="#copy-to-tmp-table" class="headerlink" title="copy to tmp table"></a>copy to tmp table</h5><p>The thread is processing an ALTER TABLE statement. This state occurs after the table with the new structure has been created but before rows are copied into it.</p>
<p>线程正在处理一个ALTER TABLE语句。这个状态发生在新的表结构已经创建之后，但是在数据被复制进入之前。</p>
<h5 id="Copying-to-group-table"><a href="#Copying-to-group-table" class="headerlink" title="Copying to group table"></a>Copying to group table</h5><p>If a statement has different ORDER BY and GROUP BY criteria, the rows are sorted by group and copied to a temporary table.</p>
<p>如果一个语句有不同的ORDER BY和GROUP BY条件，数据会被复制到一个临时表中并且按组排序。</p>
<h5 id="Copying-to-tmp-table"><a href="#Copying-to-tmp-table" class="headerlink" title="Copying to tmp table"></a>Copying to tmp table</h5><p>The server is copying to a temporary table in memory.</p>
<p>线程将数据写入内存中的临时表。</p>
<h5 id="Copying-to-tmp-table-on-disk"><a href="#Copying-to-tmp-table-on-disk" class="headerlink" title="Copying to tmp table on disk"></a>Copying to tmp table on disk</h5><p>The server is copying to a temporary table on disk. The temporary result set has become too large (see Section 8.4.3.3, “How MySQL Uses Internal Temporary Tables”). Consequently, the thread is changing the temporary table from in-memory to diskbased format to save memory.</p>
<p>线程正在将数据写入磁盘中的临时表。临时表的结果集过大（大于tmp_table_size）。所以，线程将临时表由基于内存模式改为基于磁盘模式，以节省内存。</p>
<h5 id="Creating-index"><a href="#Creating-index" class="headerlink" title="Creating index"></a>Creating index</h5><p>The thread is processing ALTER TABLE … ENABLE KEYS for a MyISAM table.</p>
<p>线程正在对一个MyISAM表执行ALTER TABLE … ENABLE KEYS语句。</p>
<h5 id="Creating-sort-index"><a href="#Creating-sort-index" class="headerlink" title="Creating sort index"></a>Creating sort index</h5><p>The thread is processing a SELECT that is resolved using an internal temporary table.</p>
<p>线程正在使用内部临时表处理一个SELECT 操作。</p>
<h5 id="creating-table"><a href="#creating-table" class="headerlink" title="creating table"></a>creating table</h5><p>The thread is creating a table. This includes creation of temporary tables.</p>
<p>线程正在创建一个表，包括创建临时表。</p>
<h5 id="Creating-tmp-table"><a href="#Creating-tmp-table" class="headerlink" title="Creating tmp table"></a>Creating tmp table</h5><p>The thread is creating a temporary table in memory or on disk. If the table is created in memory but later is converted to an ondisk table, the state during that operation will be Copying to tmp table on disk.</p>
<p>线程正在创建一个临时表在内存或者磁盘上。如果这个表创建在内存上但是之后被转换到磁盘上，这个状态在运行Copying to tmp table on disk 的时候保持。</p>
<h5 id="deleting-from-main-table"><a href="#deleting-from-main-table" class="headerlink" title="deleting from main table"></a>deleting from main table</h5><p>The server is executing the first part of a multiple-table delete. It is deleting only from the first table, and saving columns and offsets to be used for deleting from the other (reference) tables.</p>
<p>线程正在执行多表删除的第一部分，只从第一个表中删除。并且保存列和偏移量用来从其他（参考）表删除。</p>
<h5 id="deleting-from-reference-tables"><a href="#deleting-from-reference-tables" class="headerlink" title="deleting from reference tables"></a>deleting from reference tables</h5><p>The server is executing the second part of a multiple-table delete and deleting the matched rows from the other tables.</p>
<p>线程正在执行多表删除的第二部分，并从其他表中删除匹配的行。</p>
<h5 id="discard-or-import-tablespace"><a href="#discard-or-import-tablespace" class="headerlink" title="discard_or_import_tablespace"></a>discard_or_import_tablespace</h5><p>The thread is processing an ALTER TABLE … DISCARD TABLESPACE or ALTER TABLE … IMPORT TABLESPACE statement.</p>
<p>线程正在执行ALTER TABLE … DISCARD TABLESPACE 或 ALTER TABLE … IMPORT TABLESPACE语句。</p>
<h5 id="end"><a href="#end" class="headerlink" title="end"></a>end</h5><p>This occurs at the end but before the cleanup of ALTER TABLE, CREATE VIEW, DELETE, INSERT, SELECT, or UPDATE statements.</p>
<p>这个状态出现在结束时，但是在对ALTER TABLE, CREATE VIEW, DELETE, INSERT, SELECT, 或者 UPDATE 语句进行清理之前。</p>
<h5 id="executing"><a href="#executing" class="headerlink" title="executing"></a>executing</h5><p>The thread has begun executing a statement.</p>
<p>该线程已开始执行一条语句。</p>
<h5 id="Execution-of-init-command"><a href="#Execution-of-init-command" class="headerlink" title="Execution of init_command"></a>Execution of init_command</h5><p>The thread is executing statements in the value of the init_command system variable.</p>
<p>线程正在执行处于init_command系统变量的值中的语句。</p>
<h5 id="freeing-items"><a href="#freeing-items" class="headerlink" title="freeing items"></a>freeing items</h5><p>The thread has executed a command. Some freeing of items done during this state involves the query cache. This state is usually followed by cleaning up.</p>
<p>线程已经执行了命令。在这个状态中涉及的查询缓存可以得到一些释放。这个状态通常后面跟随cleaning up状态。</p>
<h5 id="Flushing-tables"><a href="#Flushing-tables" class="headerlink" title="Flushing tables"></a>Flushing tables</h5><p>The thread is executing FLUSH TABLES and is waiting for all threads to close their tables.</p>
<p>线程正在执行FLUSH TABLES 并且等待所有线程关闭他们的表。</p>
<h5 id="FULLTEXT-initialization"><a href="#FULLTEXT-initialization" class="headerlink" title="FULLTEXT initialization"></a>FULLTEXT initialization</h5><p>The server is preparing to perform a natural-language full-text search.</p>
<p>服务器正在准备进行自然语言全文检索。</p>
<h5 id="init"><a href="#init" class="headerlink" title="init"></a>init</h5><p>This occurs before the initialization of ALTER TABLE, DELETE, INSERT, SELECT, or UPDATE statements. Actions taken by the server in this state include flushing the binary log, the InnoDB log, and some query cache cleanup operations.</p>
<p>For the end state, the following operations could be happening:</p>
<p>• Removing query cache entries after data in a table is changed</p>
<p>• Writing an event to the binary log</p>
<p>• Freeing memory buffers, including for blobs</p>
<p>这个状态出现在线程初始化ALTER TABLE, DELETE, INSERT, SELECT, 或 UPDATE语句之前。服务器在这种状态下进行的操作，包括：刷新全日志、Innodb日志，和一些查询缓存清理操作。</p>
<p>对于end状态，可能会发生下列操作：</p>
<p>在表中的数据变更之后移除查询缓存。</p>
<p>将事务写入全日志。</p>
<p>释放内存缓冲区，包括大的二进制数据块。</p>
<h5 id="Killed"><a href="#Killed" class="headerlink" title="Killed"></a>Killed</h5><p>Someone has sent a KILL statement to the thread and it should abort next time it checks the kill flag. The flag is checked in each major loop in MySQL, but in some cases it might still take a short time for the thread to die. If the thread is locked by some other thread, the kill takes effect as soon as the other thread releases its lock.</p>
<p>程序对线程发送了KILL语句，并且它应该放弃下一次对KILL标记的检查。这个标记在每一个MySQL的主要循环中被检查，但在某些情况下，它可能需要令线程在很短的时间内死亡。如果这个线程被其他线程锁住了，这个KILL操作会在其他线程释放锁的瞬时执行。</p>
<h5 id="Locked"><a href="#Locked" class="headerlink" title="Locked"></a>Locked</h5><p>The query is locked by another query.</p>
<p>As of MySQL 5.5.3, this state was removed because it was equivalent to the Table lock state and no longer appears in SHOW PROCESSLIST output.</p>
<p>这个查询被其他查询锁住了。</p>
<p>在MySQL 5.5.3版本，这个状态被移除了。因为它相当于表锁状态，并且不再出现在SHOW PROCESSLIST输出中。</p>
<h5 id="logging-slow-query"><a href="#logging-slow-query" class="headerlink" title="logging slow query"></a>logging slow query</h5><p>The thread is writing a statement to the slow-query log.</p>
<p>这个线程正在将语句写入慢查询日志。</p>
<h5 id="NULL"><a href="#NULL" class="headerlink" title="NULL"></a>NULL</h5><p>This state is used for the SHOW PROCESSLIST state.</p>
<p>没有操作的状态。</p>
<h5 id="login"><a href="#login" class="headerlink" title="login"></a>login</h5><p>The initial state for a connection thread until the client has been authenticated successfully.</p>
<p>线程连接的初始状态。直到客户端已经成功验证。</p>
<h5 id="manage-keys"><a href="#manage-keys" class="headerlink" title="manage keys"></a>manage keys</h5><p>The server is enabling or disabling a table index.</p>
<p>服务器启用或禁用表索引。</p>
<h5 id="Opening-tables-Opening-table"><a href="#Opening-tables-Opening-table" class="headerlink" title="Opening tables, Opening table"></a>Opening tables, Opening table</h5><p>The thread is trying to open a table. This is should be very fast procedure, unless something prevents opening. For example, an ALTER TABLE or a LOCK TABLE statement can prevent opening a table until the statement is finished. It is also worth checking that your table_open_cache value is large enough.</p>
<p>线程正试图打开一张表。这应该是非常快的过程，除非打开受到阻止。一个ALTER TABLE 或LOCK TABLE语句能够阻止打开一张表直到语句运行结束。有必要检查table_open_cache的值是否足够大。</p>
<h5 id="optimizing"><a href="#optimizing" class="headerlink" title="optimizing"></a>optimizing</h5><p>The server is performing initial optimizations for a query.</p>
<p>服务器执行查询的初步优化。</p>
<h5 id="preparing"><a href="#preparing" class="headerlink" title="preparing"></a>preparing</h5><p>This state occurs during query optimization.</p>
<p>在查询优化过程中出现这个状态。</p>
<h5 id="Purging-old-relay-logs"><a href="#Purging-old-relay-logs" class="headerlink" title="Purging old relay logs"></a>Purging old relay logs</h5><p>The thread is removing unneeded relay log files.</p>
<p>线程正在移除不必要的中继日志文件。</p>
<h5 id="query-end"><a href="#query-end" class="headerlink" title="query end"></a>query end</h5><p>This state occurs after processing a query but before the freeing items state.</p>
<p>这个状态出现在处理一个查询之后，但是在freeing items状态之前。</p>
<h5 id="Reading-from-net"><a href="#Reading-from-net" class="headerlink" title="Reading from net"></a>Reading from net</h5><p>The server is reading a packet from the network.</p>
<p>服务器正在从网络阅读数据包。</p>
<h5 id="Removing-duplicates"><a href="#Removing-duplicates" class="headerlink" title="Removing duplicates"></a>Removing duplicates</h5><p>The query was using SELECT DISTINCT in such a way that MySQL could not optimize away the distinct operation at an early stage. Because of this, MySQL requires an extra stage to remove all duplicated rows before sending the result to the client.</p>
<p>查询正在使用SELECT DISTINCT，这种情况下MySQL不能在早期阶段优化掉一些distinct操作。因此，MySQL需要一个额外的阶段，在将结果发送到客户端之前删除所有重复的行。</p>
<h5 id="removing-tmp-table"><a href="#removing-tmp-table" class="headerlink" title="removing tmp table"></a>removing tmp table</h5><p>The thread is removing an internal temporary table after processing a SELECT statement. This state is not used if no temporary table was created.</p>
<p>线程正在移除一个内置临时表，在执行一条SELECT语句之后。 如果没有临时表产生，那么这个状态不被使用。</p>
<h5 id="rename"><a href="#rename" class="headerlink" title="rename"></a>rename</h5><p>The thread is renaming a table.</p>
<p>线程正在重命名一张表。</p>
<h5 id="rename-result-table"><a href="#rename-result-table" class="headerlink" title="rename result table"></a>rename result table</h5><p>The thread is processing an ALTER TABLE statement, has created the new table, and is renaming it to replace the original table.</p>
<p>线程正在处理ALTER TABLE语句，创建新的表，并且重命名它来代替原有的表。</p>
<h5 id="Reopen-tables"><a href="#Reopen-tables" class="headerlink" title="Reopen tables"></a>Reopen tables</h5><p>The thread got a lock for the table, but noticed after getting the lock that the underlying table structure changed. It has freed the lock, closed the table, and is trying to reopen it.</p>
<p>线程获得了表锁，但是在取得表锁之后才发现该表的底层结构已经发生了变化。线程释放这个锁，关闭表，并试图重新打开该表。</p>
<h5 id="Repair-by-sorting"><a href="#Repair-by-sorting" class="headerlink" title="Repair by sorting"></a>Repair by sorting</h5><p>The repair code is using a sort to create indexes.</p>
<p>修复代码正在使用一个分类来创建索引。</p>
<h5 id="Repair-done"><a href="#Repair-done" class="headerlink" title="Repair done"></a>Repair done</h5><p>The thread has completed a multi-threaded repair for a MyISAM table.</p>
<p>线程完成一个多线程的MyISAM表的修复。</p>
<h5 id="Repair-with-keycache"><a href="#Repair-with-keycache" class="headerlink" title="Repair with keycache"></a>Repair with keycache</h5><p>The repair code is using creating keys one by one through the key cache. This is much slower than Repair by sorting.</p>
<p>修复代码正在通过索引缓存一个接一个地使用创建索引。这比通过分类修复要慢很多。</p>
<h5 id="Rolling-back"><a href="#Rolling-back" class="headerlink" title="Rolling back"></a>Rolling back</h5><p>The thread is rolling back a transaction.</p>
<p>线程正在回滚一个事务</p>
<h5 id="Saving-state"><a href="#Saving-state" class="headerlink" title="Saving state"></a>Saving state</h5><p>For MyISAM table operations such as repair or analysis, the thread is saving the new table state to the .MYI file header. State includes information such as number of rows, the AUTO_INCREMENT counter, and key distributions.</p>
<p>对于MyISAM表的类似repair或analysis操作，线程在.MYI文件的头部保存一个新表的状态。状态信息包括行数、自增数、索引分布等等。</p>
<h5 id="Searching-rows-for-update"><a href="#Searching-rows-for-update" class="headerlink" title="Searching rows for update"></a>Searching rows for update</h5><p>The thread is doing a first phase to find all matching rows before updating them. This has to be done if the UPDATE is changing the index that is used to find the involved rows.</p>
<p>线程正在进行第一阶段，在更新前寻找所有匹配的行。如果update正在更改用于查找相关行的索引，则必须这么做。</p>
<h5 id="Sending-data"><a href="#Sending-data" class="headerlink" title="Sending data"></a>Sending data</h5><p>The thread is reading and processing rows for a SELECT statement, and sending data to the client. Because operations occurring during this this state tend to perform large amounts of disk access (reads), it is often the longest-running state over the lifetime of a given query.</p>
<p>线程正在读取和处理一条SELECT语句的行，并且将数据发送至客户端。由于在此期间会执行大量的磁盘访问（读操作），这个状态在一个指定查询的生命周期中经常是耗时最长的。</p>
<h5 id="setup"><a href="#setup" class="headerlink" title="setup"></a>setup</h5><p>The thread is beginning an ALTER TABLE operation.</p>
<p>线程正开始进行一个ALTER TABLE操作。</p>
<h5 id="Sorting-for-group"><a href="#Sorting-for-group" class="headerlink" title="Sorting for group"></a>Sorting for group</h5><p>The thread is doing a sort to satisfy a GROUP BY.</p>
<p>线程正在执行一个由GROUP BY指定的排序。</p>
<h5 id="Sorting-for-order"><a href="#Sorting-for-order" class="headerlink" title="Sorting for order"></a>Sorting for order</h5><p>The thread is doing a sort to satisfy a ORDER BY.</p>
<p>线程正在执行一个由ORDER BY指定的排序。</p>
<h5 id="Sorting-index"><a href="#Sorting-index" class="headerlink" title="Sorting index"></a>Sorting index</h5><p>The thread is sorting index pages for more efficient access during a MyISAM table optimization operation.</p>
<p>线程正在对索引页进行排序，为了对MyISAM表进行操作时获得更优的性能。</p>
<h5 id="Sorting-result"><a href="#Sorting-result" class="headerlink" title="Sorting result"></a>Sorting result</h5><p>For a SELECT statement, this is similar to Creating sort index, but for nontemporary tables.</p>
<p>对于一个SELECT语句，这与创建排序索引相似，但是是对非临时表。</p>
<h5 id="statistics"><a href="#statistics" class="headerlink" title="statistics"></a>statistics</h5><p>The server is calculating statistics to develop a query execution plan. If a thread is in this state for a long time, the server is probably disk-bound performing other work.</p>
<p>服务器计算统计去规划一个查询。如果一个线程长时间处于这个状态，这个服务器的磁盘可能在执行其他工作。</p>
<h5 id="System-lock"><a href="#System-lock" class="headerlink" title="System lock"></a>System lock</h5><p>The thread is going to request or is waiting for an internal or external system lock for the table. If this state is being caused by requests for external locks and you are not using multiple mysqld servers that are accessing the same MyISAM tables, you can disable external system locks with the –skip-external-locking option. However, external locking is disabled by default, so it is likely that this option will have no effect. For SHOW PROFILE, this state means the thread is requesting the lock</p>
<p>(not waiting for it).</p>
<p>这个线程正在请求或者等待一个内部的或外部的系统表锁。如果这个状态是由于外部锁的请求产生的，并且你没有使用多个正在访问相同的表的mysqld服务器，那么你可以使用–skip-external-locking选项禁用外部系统锁。然而，外部系统锁默认情况下禁用，因此这个选项可能不会产生效果。对于SHOW PROFILE，这个状态意味着线程正在请求锁。（而非等待）</p>
<h5 id="Table-lock"><a href="#Table-lock" class="headerlink" title="Table lock"></a>Table lock</h5><p>The next thread state after System lock. The thread has acquired an external lock and is going to request an internal table lock.</p>
<p>This state was replaced in MySQL 5.5.6 with Waiting for table level lock.</p>
<p>系统锁定后的下一个线程状态。线程已获得外部锁并且将请求内部表锁。</p>
<p>这个状态在MySQL 5.5.6版本中被Waiting for table level lock取代。</p>
<h5 id="Updating"><a href="#Updating" class="headerlink" title="Updating"></a>Updating</h5><p>The thread is searching for rows to update and is updating them.</p>
<p>线程寻找更新匹配的行并进行更新。</p>
<h5 id="updating-main-table"><a href="#updating-main-table" class="headerlink" title="updating main table"></a>updating main table</h5><p>The server is executing the first part of a multiple-table update. It is updating only the first table, and saving columns and offsets to be used for updating the other (reference) tables.</p>
<p>线程正在执行多表更新的第一部分，只从第一个表中更新。并且保存列和偏移量用来从其他（参考）表更新。</p>
<h5 id="updating-reference-tables"><a href="#updating-reference-tables" class="headerlink" title="updating reference tables"></a>updating reference tables</h5><p>The server is executing the second part of a multiple-table update and updating the matched rows from the other tables.</p>
<p>线程正在执行多表更新的第二部分，并从其他表中更新匹配的行。</p>
<h5 id="User-lock"><a href="#User-lock" class="headerlink" title="User lock"></a>User lock</h5><p>The thread is going to request or is waiting for an advisory lock requested with a GET_LOCK() call. For SHOW PROFILE, this state means the thread is requesting the lock (not waiting for it).</p>
<p>线程正在请求或等待一个GET_LOCK()调用所要求的咨询锁。对于SHOW PROFILE，这个状态意味这线程正在请求锁。（而非等待）</p>
<h5 id="User-sleep"><a href="#User-sleep" class="headerlink" title="User sleep"></a>User sleep</h5><p>The thread has invoked a SLEEP() call.</p>
<p>线程调用了一个SLEEP()。</p>
<h5 id="Waiting-for-all-running-commits-to-finish"><a href="#Waiting-for-all-running-commits-to-finish" class="headerlink" title="Waiting for all running commits to finish"></a>Waiting for all running commits to finish</h5><p>A statement that causes an explicit or implicit commit is waiting for release of a read lock. This state was removed in MySQL 5.5.8; Waiting for commit lock is used instead.</p>
<p>一个显式或隐式语句在提交时等待释放读锁。这个状态在MySQL 5.5.8版本中被移除，以Waiting for commit lock代替。</p>
<h5 id="Waiting-for-commit-lock"><a href="#Waiting-for-commit-lock" class="headerlink" title="Waiting for commit lock"></a>Waiting for commit lock</h5><p>A statement that causes an explicit or implicit commit is waiting for release of a read lock or FLUSH TABLES WITH READ LOCK) is waiting for a commit lock. This state was added in MySQL 5.5.8.</p>
<p>同上，这个状态于MySQL 5.5.8版本加入。</p>
<h5 id="Waiting-for-global-read-lock"><a href="#Waiting-for-global-read-lock" class="headerlink" title="Waiting for global read lock"></a>Waiting for global read lock</h5><p>FLUSH TABLES WITH READ LOCK) is waiting for a global read lock.</p>
<p>等待全局读锁。</p>
<h5 id="Waiting-for-release-of-readlock"><a href="#Waiting-for-release-of-readlock" class="headerlink" title="Waiting for release of readlock"></a>Waiting for release of readlock</h5><p>The thread is waiting for a global read lock obtained by another thread (with FLUSH TABLES WITH READ LOCK) to be released.This state was removed in MySQL 5.5.8; Waiting for global read lock or Waiting for commit lock are used instead.</p>
<p>等待释放读锁。</p>
<h5 id="Waiting-for-tables-Waiting-for-table-Waiting-for-table-flush"><a href="#Waiting-for-tables-Waiting-for-table-Waiting-for-table-flush" class="headerlink" title="Waiting for tables, Waiting for table, Waiting for table flush"></a>Waiting for tables, Waiting for table, Waiting for table flush</h5><p>The thread got a notification that the underlying structure for a table has changed and it needs to reopen the table to get the new structure. However, to reopen the table, it must wait until all other threads have closed the table in question.</p>
<p>This notification takes place if another thread has used FLUSH TABLES or one of the following statements on the table in question: FLUSH TABLES _tbl<em>name</em>, ALTER TABLE, RENAME TABLE, REPAIR TABLE, ANALYZE TABLE, or OPTIMIZE TABLE.</p>
<p>In MySQL 5.5.6, Waiting for table was replaced with Waiting for table flush.</p>
<p>线程获得一个通知，底层表结构已经发生变化，它需要重新打开表来获取新的结构。然而，重新打开表，它必须等到所有其他线程关闭这个有问题的表。</p>
<p>这个通知产生通常因为另一个线程对问题表执行了FLUSH TABLES或者以下语句之一：FLUSH TABLES _tbl<em>name</em>, ALTER TABLE, RENAME TABLE, REPAIR TABLE, ANALYZE TABLE, or OPTIMIZE TABLE.</p>
<h5 id="Waiting-for-lock-type-lock"><a href="#Waiting-for-lock-type-lock" class="headerlink" title="Waiting for _lock_type _lock"></a>Waiting for _lock_type _lock</h5><p>The server is waiting to acquire a lock, where _lock_type _indicates the type of lock:</p>
<p>• Waiting for event metadata lock (added in MySQL 5.5.8)</p>
<p>• Waiting for global metadata lock (replaced by Waiting for global read lock in MySQL 5.5.8)</p>
<p>• Waiting for global read lock (added in MySQL 5.5.8)</p>
<p>• Waiting for schema metadata lock</p>
<p>• Waiting for stored function metadata lock</p>
<p>• Waiting for stored procedure metadata lock</p>
<p>• Waiting for table level lock</p>
<p>• Waiting for table metadata lock</p>
<p>• Waiting for trigger metadata lock (added in MySQL 5.5.8)</p>
<p>等待各个种类的表锁。</p>
<h5 id="Waiting-on-cond"><a href="#Waiting-on-cond" class="headerlink" title="Waiting on cond"></a>Waiting on cond</h5><p>A generic state in which the thread is waiting for a condition to become true. No specific state information is available.</p>
<p>一个普通的状态，线程正在等待一个条件为真。没有特定的状态信息可用。</p>
<h5 id="Waiting-to-get-readlock"><a href="#Waiting-to-get-readlock" class="headerlink" title="Waiting to get readlock"></a>Waiting to get readlock</h5><p>The thread has issued a FLUSH TABLES WITH READ LOCK statement to obtain a global read lock and is waiting to obtain the lock. This state was removed in MySQL 5.5.8; Waiting for global read lock is used instead.</p>
<p>线程发出了一个FLUSH TABLES WITH READ LOCK语句来获取一个全局读锁，并且等待获得这个锁。这个状态在MySQL 5.5.8被移除，使用Waiting for global read lock 来代替。</p>
<h5 id="Writing-to-net"><a href="#Writing-to-net" class="headerlink" title="Writing to net"></a>Writing to net</h5><p>The server is writing a packet to the network.</p>
<p>服务器正在写一个网络数据包。</p>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>坚持原创分享，您的支持将鼓励我继续创作</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.png" alt="Geekwolf WeChat Pay"/>
        <p>微信打赏</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.png" alt="Geekwolf Alipay"/>
        <p>支付宝打赏</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    Geekwolf
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://www.simlinux.com/2012/08/15/show-processlist-e7-bb-93-e6-9e-9c-e4-b8-adstatus-e7-8a-b6-e6-80-81-e6-80-bb-e7-bb-93.html" title="show processlist结果中status状态总结">http://www.simlinux.com/2012/08/15/show-processlist-e7-bb-93-e6-9e-9c-e4-b8-adstatus-e7-8a-b6-e6-80-81-e6-80-bb-e7-bb-93.html</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Mysql/" rel="tag"># Mysql</a>
          
            <a href="/tags/processlist状态/" rel="tag"># processlist状态</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2012/08/11/weblogic-11g-e9-87-8d-e7-bd-ae-e7-94-a8-e6-88-b7-e5-af-86-e7-a0-81-e8-bf-87-e7-a8-8b.html" rel="next" title="WebLogic 11g重置用户密码过程">
                <i class="fa fa-chevron-left"></i> WebLogic 11g重置用户密码过程
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2012/08/15/rsync-rsync-ssh-rsync-lsyncd-e5-a4-9a-e7-a7-8d-e5-90-8c-e6-ad-a5-e6-96-b9-e6-a1-88-e4-b8-8e-e6-af-94-e8-be-83.html" rel="prev" title="rsync , rsync + ssh, rsync + lsyncd 多种同步方案与比较">
                rsync , rsync + ssh, rsync + lsyncd 多种同步方案与比较 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zMDc3Mi83MzI0"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/wolf.jpeg"
               alt="Geekwolf" />
          <p class="site-author-name" itemprop="name">Geekwolf</p>
           
              <p class="site-description motion-element" itemprop="description">DevOps | Docker | K8S | MySQL | 运维</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">167</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">12</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">105</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        
          <div class="feed-link motion-element">
            <a href="/atom.xml" rel="alternate">
              <i class="fa fa-rss"></i>
              RSS
            </a>
          </div>
        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/geekwolf" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                    
                      GitHub
                    
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://weibo.com/geekwolf" target="_blank" title="Weibo">
                  
                    <i class="fa fa-fw fa-weibo"></i>
                  
                    
                      Weibo
                    
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-5"><a class="nav-link" href="#After-create"><span class="nav-number">1.</span> <span class="nav-text">After create</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Analyzing"><span class="nav-number">2.</span> <span class="nav-text">Analyzing</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#checking-permissions"><span class="nav-number">3.</span> <span class="nav-text">checking permissions</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Checking-table"><span class="nav-number">4.</span> <span class="nav-text">Checking table</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#cleaning-up"><span class="nav-number">5.</span> <span class="nav-text">cleaning up</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#closing-tables"><span class="nav-number">6.</span> <span class="nav-text">closing tables</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#converting-HEAP-to-MyISAM"><span class="nav-number">7.</span> <span class="nav-text">converting HEAP to MyISAM</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#copy-to-tmp-table"><span class="nav-number">8.</span> <span class="nav-text">copy to tmp table</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Copying-to-group-table"><span class="nav-number">9.</span> <span class="nav-text">Copying to group table</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Copying-to-tmp-table"><span class="nav-number">10.</span> <span class="nav-text">Copying to tmp table</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Copying-to-tmp-table-on-disk"><span class="nav-number">11.</span> <span class="nav-text">Copying to tmp table on disk</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Creating-index"><span class="nav-number">12.</span> <span class="nav-text">Creating index</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Creating-sort-index"><span class="nav-number">13.</span> <span class="nav-text">Creating sort index</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#creating-table"><span class="nav-number">14.</span> <span class="nav-text">creating table</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Creating-tmp-table"><span class="nav-number">15.</span> <span class="nav-text">Creating tmp table</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#deleting-from-main-table"><span class="nav-number">16.</span> <span class="nav-text">deleting from main table</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#deleting-from-reference-tables"><span class="nav-number">17.</span> <span class="nav-text">deleting from reference tables</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#discard-or-import-tablespace"><span class="nav-number">18.</span> <span class="nav-text">discard_or_import_tablespace</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#end"><span class="nav-number">19.</span> <span class="nav-text">end</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#executing"><span class="nav-number">20.</span> <span class="nav-text">executing</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Execution-of-init-command"><span class="nav-number">21.</span> <span class="nav-text">Execution of init_command</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#freeing-items"><span class="nav-number">22.</span> <span class="nav-text">freeing items</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Flushing-tables"><span class="nav-number">23.</span> <span class="nav-text">Flushing tables</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#FULLTEXT-initialization"><span class="nav-number">24.</span> <span class="nav-text">FULLTEXT initialization</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#init"><span class="nav-number">25.</span> <span class="nav-text">init</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Killed"><span class="nav-number">26.</span> <span class="nav-text">Killed</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Locked"><span class="nav-number">27.</span> <span class="nav-text">Locked</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#logging-slow-query"><span class="nav-number">28.</span> <span class="nav-text">logging slow query</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#NULL"><span class="nav-number">29.</span> <span class="nav-text">NULL</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#login"><span class="nav-number">30.</span> <span class="nav-text">login</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#manage-keys"><span class="nav-number">31.</span> <span class="nav-text">manage keys</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Opening-tables-Opening-table"><span class="nav-number">32.</span> <span class="nav-text">Opening tables, Opening table</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#optimizing"><span class="nav-number">33.</span> <span class="nav-text">optimizing</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#preparing"><span class="nav-number">34.</span> <span class="nav-text">preparing</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Purging-old-relay-logs"><span class="nav-number">35.</span> <span class="nav-text">Purging old relay logs</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#query-end"><span class="nav-number">36.</span> <span class="nav-text">query end</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Reading-from-net"><span class="nav-number">37.</span> <span class="nav-text">Reading from net</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Removing-duplicates"><span class="nav-number">38.</span> <span class="nav-text">Removing duplicates</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#removing-tmp-table"><span class="nav-number">39.</span> <span class="nav-text">removing tmp table</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#rename"><span class="nav-number">40.</span> <span class="nav-text">rename</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#rename-result-table"><span class="nav-number">41.</span> <span class="nav-text">rename result table</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Reopen-tables"><span class="nav-number">42.</span> <span class="nav-text">Reopen tables</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Repair-by-sorting"><span class="nav-number">43.</span> <span class="nav-text">Repair by sorting</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Repair-done"><span class="nav-number">44.</span> <span class="nav-text">Repair done</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Repair-with-keycache"><span class="nav-number">45.</span> <span class="nav-text">Repair with keycache</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Rolling-back"><span class="nav-number">46.</span> <span class="nav-text">Rolling back</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Saving-state"><span class="nav-number">47.</span> <span class="nav-text">Saving state</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Searching-rows-for-update"><span class="nav-number">48.</span> <span class="nav-text">Searching rows for update</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Sending-data"><span class="nav-number">49.</span> <span class="nav-text">Sending data</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#setup"><span class="nav-number">50.</span> <span class="nav-text">setup</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Sorting-for-group"><span class="nav-number">51.</span> <span class="nav-text">Sorting for group</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Sorting-for-order"><span class="nav-number">52.</span> <span class="nav-text">Sorting for order</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Sorting-index"><span class="nav-number">53.</span> <span class="nav-text">Sorting index</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Sorting-result"><span class="nav-number">54.</span> <span class="nav-text">Sorting result</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#statistics"><span class="nav-number">55.</span> <span class="nav-text">statistics</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#System-lock"><span class="nav-number">56.</span> <span class="nav-text">System lock</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Table-lock"><span class="nav-number">57.</span> <span class="nav-text">Table lock</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Updating"><span class="nav-number">58.</span> <span class="nav-text">Updating</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#updating-main-table"><span class="nav-number">59.</span> <span class="nav-text">updating main table</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#updating-reference-tables"><span class="nav-number">60.</span> <span class="nav-text">updating reference tables</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#User-lock"><span class="nav-number">61.</span> <span class="nav-text">User lock</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#User-sleep"><span class="nav-number">62.</span> <span class="nav-text">User sleep</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Waiting-for-all-running-commits-to-finish"><span class="nav-number">63.</span> <span class="nav-text">Waiting for all running commits to finish</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Waiting-for-commit-lock"><span class="nav-number">64.</span> <span class="nav-text">Waiting for commit lock</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Waiting-for-global-read-lock"><span class="nav-number">65.</span> <span class="nav-text">Waiting for global read lock</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Waiting-for-release-of-readlock"><span class="nav-number">66.</span> <span class="nav-text">Waiting for release of readlock</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Waiting-for-tables-Waiting-for-table-Waiting-for-table-flush"><span class="nav-number">67.</span> <span class="nav-text">Waiting for tables, Waiting for table, Waiting for table flush</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Waiting-for-lock-type-lock"><span class="nav-number">68.</span> <span class="nav-text">Waiting for _lock_type _lock</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Waiting-on-cond"><span class="nav-number">69.</span> <span class="nav-text">Waiting on cond</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Waiting-to-get-readlock"><span class="nav-number">70.</span> <span class="nav-text">Waiting to get readlock</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Writing-to-net"><span class="nav-number">71.</span> <span class="nav-text">Writing to net</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2012 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Geekwolf</span>
</div>

        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.2"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('-1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("qms5kJ0y2CItrIVFivKxxPsR-gzGzoHsz", "Cn3w20futtphxpaDSP5tHjzy");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  

  

</body>
</html>
